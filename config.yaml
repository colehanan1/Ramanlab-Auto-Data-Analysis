
# Project configuration
model_path: "/home/ramanlab/Documents/cole/sam2/notebooks/YOLOProjectProboscisLegs/runs/obb/train5/weights/best.pt"
main_directory: "/home/ramanlab/Documents/cole/Data/flys/opto_benz_1/"

reaction_prediction:
  data_csv: "/home/ramanlab/Documents/cole/Data/Opto/Combined/all_envelope_rows_wide.csv"
  model_path: "/home/ramanlab/PycharmProjects/FlyBehaviorScoring/artifacts/2025-10-17T20-16-59Z/model_mlp.joblib"
  output_csv: "/home/ramanlab/Documents/cole/Data/Opto/Combined/model_predictions.csv"
  matrix:
    out_dir: "/home/ramanlab/Documents/cole/Results/Opto/Combined/Reaction_Predictions"
    latency_sec: 2.15
    after_window_sec: 30.0
    row_gap: 0.6
    height_per_gap_in: 3.0
    bottom_shift_in: 0.5
    trial_orders: ["observed", "trained-first"]
    include_hexanol: true
    overwrite: false

# Compute
allow_cpu: false
cuda_allow_tf32: true

# Detection / tracking
yolo:
  conf_thres: 0.40
  iou_match_thres: 0.25
  max_age: 5
  ema_alpha: 0.20
  use_optical_flow: true
  flow_skip_edge: 10
  max_flies: 3
  max_proboscis_tracks: 3
  pair_rebind_ratio: 0.20
  zero_iou_epsilon: 1.0e-8

# Geometry
anchor_x: 1079.0
anchor_y: 540.0

# Distance stats
distance_limits:
  class2_min: 10.0
  class2_max: 250.0

# Reaction filtering
non_reactive_span_px: 20.0  # flag flies when global span â‰¤ this threshold (pixels)

# Envelope / RMS
fps_default: 40.0
window_sec: 0.25
odor_on_s: 30.0
odor_off_s: 60.0
odor_latency_s: 2.15

# Videos
delete_source_after_render: true

analysis:
  envelope_visuals:
    matrices:
      matrix_npy: "/home/ramanlab/Documents/cole/Data/single_matrix_opto/envelope_matrix_float16.npy"
      codes_json: "/home/ramanlab/Documents/cole/Data/single_matrix_opto/code_maps.json"
      out_dir: "/home/ramanlab/Documents/cole/Results/Opto/Reaction_Matrices"
      latency_sec: 0.0
      fps_default: 40.0
      before_sec: 30.0
      during_sec: 30.0
      after_window_sec: 30.0
      threshold_std_mult: 4.0
      min_samples_over: 20
      row_gap: 0.6
      height_per_gap_in: 3.0
      bottom_shift_in: 0.5
      trial_orders: ["observed", "trained-first"]
      include_hexanol: true
      overwrite: false
    envelopes:
      matrix_npy: "/home/ramanlab/Documents/cole/Data/single_matrix_opto/envelope_matrix_float16.npy"
      codes_json: "/home/ramanlab/Documents/cole/Data/single_matrix_opto/code_maps.json"
      out_dir: "/home/ramanlab/Documents/cole/Results/Opto/Envlope_DIST"
      latency_sec: 0.0
      fps_default: 40.0
      odor_on_s: 30.0
      odor_off_s: 60.0
      odor_latency_s: 2.15
      after_show_sec: 30.0
      threshold_std_mult: 4.0
      trial_type: testing
      overwrite: false
  training:
    envelopes:
      matrix_npy: "/home/ramanlab/Documents/cole/Data/Opto/Combined/matrix/training/envelope_matrix_float16.npy"
      codes_json: "/home/ramanlab/Documents/cole/Data/Opto/Combined/matrix/training/code_maps.json"
      out_dir: "/home/ramanlab/Documents/cole/Results/Opto/Training_Envelopes"
      latency_sec: 0.0
      fps_default: 40.0
      odor_on_s: 30.0
      odor_off_s: 60.0
      odor_latency_s: 2.15
      after_show_sec: 30.0
      threshold_std_mult: 4.0
      trial_type: training
      overwrite: false
    latency:
      matrix_npy: "/home/ramanlab/Documents/cole/Data/single_matrix_opto/envelope_matrix_float16.npy"
      codes_json: "/home/ramanlab/Documents/cole/Data/single_matrix_opto/code_maps.json"
      out_dir: "/home/ramanlab/Documents/cole/Results/Opto/Training_Latency"
      before_sec: 30.0
      during_sec: 35.0
      threshold_mult: 4.0
      latency_ceiling: 9.5
      trials: [4, 5, 6]
      fps_default: 40.0
      overwrite: false
  combined:
    combine:
      roots:
        - "/home/ramanlab/Documents/cole/Data/flys/opto_benz_1/"
        - "/home/ramanlab/Documents/cole/Data/flys/hex_control/"
        - "/home/ramanlab/Documents/cole/Data/flys/EB_control/"
        - "/home/ramanlab/Documents/cole/Data/flys/benz_control/"
      fps_default: 40.0
      window_sec: 0.25
      odor_on: 30.0
      odor_off: 60.0
      odor_latency_s: 2.15
    wide:
      mirror:
        - source: "/home/ramanlab/Documents/cole/Data/flys/opto_benz_1/"
          destination: "/securedstorage/DATAsec/cole/Data-secured/opto_benz_1/"
      roots:
        - "/securedstorage/DATAsec/cole/Data-secured/opto_EB/"
        - "/securedstorage/DATAsec/cole/Data-secured/opto_benz_1/"
        - "/securedstorage/DATAsec/cole/Data-secured/opto_hex/"
        - "/securedstorage/DATAsec/cole/Data-secured/hex_control/"
        - "/securedstorage/DATAsec/cole/Data-secured/EB_control/"
        - "/securedstorage/DATAsec/cole/Data-secured/benz_control/"
      output_csv: "/home/ramanlab/Documents/cole/Data/Opto/Combined/all_envelope_rows_wide.csv"
      measure_cols: ["envelope_of_rms"]
      fps_fallback: 40.0
      trial_type_exports:
        - trial_type: training
          output_csv: "/home/ramanlab/Documents/cole/Data/Opto/Combined/all_envelope_rows_wide_training.csv"
          matrix_out_dir: "/home/ramanlab/Documents/cole/Data/Opto/Combined/matrix/training"
    matrix:
      input_csv: "/home/ramanlab/Documents/cole/Data/Opto/Combined/all_envelope_rows_wide.csv"
      out_dir: "/home/ramanlab/Documents/cole/Data/Opto/Combined/matrix"
    matrices:
      matrix_npy: "/home/ramanlab/Documents/cole/Data/Opto/Combined/matrix/envelope_matrix_float16.npy"
      codes_json: "/home/ramanlab/Documents/cole/Data/Opto/Combined/matrix/code_maps.json"
      out_dir: "/home/ramanlab/Documents/cole/Results/Opto/Combined/Reaction_Matrices"
      latency_sec: 0.0
      fps_default: 40.0
      before_sec: 30.0
      during_sec: 30.0
      after_window_sec: 30.0
      threshold_std_mult: 4.0
      min_samples_over: 20
      row_gap: 0.6
      height_per_gap_in: 3.0
      bottom_shift_in: 0.5
      trial_orders: ["observed", "trained-first"]
      include_hexanol: true
      overwrite: false
    envelopes:
      - matrix_npy: "/home/ramanlab/Documents/cole/Data/Opto/Combined/matrix/envelope_matrix_float16.npy"
        codes_json: "/home/ramanlab/Documents/cole/Data/Opto/Combined/matrix/code_maps.json"
        out_dir: "/home/ramanlab/Documents/cole/Results/Opto/Combined/Envelopes"
        latency_sec: 0.0
        fps_default: 40.0
        odor_on_s: 30.0
        odor_off_s: 60.0
        odor_latency_s: 2.15
        after_show_sec: 30.0
        threshold_std_mult: 4.0
        overwrite: false
      - matrix_npy: "/home/ramanlab/Documents/cole/Data/Opto/Combined/matrix/training/envelope_matrix_float16.npy"
        codes_json: "/home/ramanlab/Documents/cole/Data/Opto/Combined/matrix/training/code_maps.json"
        out_dir: "/home/ramanlab/Documents/cole/Results/Opto/Combined/Training_Envelopes"
        latency_sec: 0.0
        fps_default: 40.0
        odor_on_s: 30.0
        odor_off_s: 60.0
        odor_latency_s: 2.15
        after_show_sec: 30.0
        threshold_std_mult: 4.0
        trial_type: training
        overwrite: true
    overlay:
      combined_matrix: "/home/ramanlab/Documents/cole/Data/Opto/Combined/matrix/envelope_matrix_float16.npy"
      combined_codes: "/home/ramanlab/Documents/cole/Data/Opto/Combined/matrix/code_maps.json"
      distance_matrix: "/home/ramanlab/Documents/cole/Data/single_matrix_opto/envelope_matrix_float16.npy"
      distance_codes: "/home/ramanlab/Documents/cole/Data/single_matrix_opto/code_maps.json"
      out_dir: "/home/ramanlab/Documents/cole/Results/Opto/Combined/Overlay"
      latency_sec: 0.0
      after_show_sec: 30.0
      threshold_std_mult: 4.0
      odor_on_s: 30.0
      odor_off_s: 60.0
      odor_latency_s: 2.15
      overwrite: false
    secure_cleanup:
      destination: "/securedstorage/DATAsec/cole/Data-secured/"
      sources:
        - "/home/ramanlab/Documents/cole/Data/flys/opto_EB/"
        - "/home/ramanlab/Documents/cole/Data/flys/opto_benz_1/"
        - "/home/ramanlab/Documents/cole/Data/flys/opto_hex/"
        - "/home/ramanlab/Documents/cole/Data/flys/hex_control/"

